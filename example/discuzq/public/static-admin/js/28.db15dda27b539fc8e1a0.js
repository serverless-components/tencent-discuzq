(window.webpackJsonp=window.webpackJsonp||[]).push([[28],{"3Fxs":function(e,t,r){},Jmiy:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=a(r("QbLZ")),n=r("WIBD"),s=a(r("VVfg"));function a(e){return e&&e.__esModule?e:{default:e}}t.default={data:function(){return{checked:!1,form:{user:"",password:""},rules:{user:[{required:!0,message:"请输入用户名",trigger:"blur"}],password:[{required:!0,message:"请输入密码",trigger:"blur"}]},tokenId:"",loginLoading:!1}},methods:(0,o.default)({},(0,n.mapMutations)({setLoginState:"login/SET_LOGIN_STATE"}),{adminLogin:function(e){var t=this;this.loginLoading=!0,this.$refs[e].validate((function(e){if(!e)return t.loginLoading=!1,!1;t.postLogin().then((function(e){if(e.errors)e.errors[0].detail?t.$message.error(e.errors[0].code+"\n"+e.errors[0].detail[0]):t.$message.error(e.errors[0].code),t.loginLoading=!1;else{var r=e.data.attributes.access_token,o=e.data.id,n=e.data.attributes.refresh_token;s.default.setLItem("Authorization",r),s.default.setLItem("tokenId",o),s.default.setLItem("refreshToken",n),r&&o?t.getUserInfo(o).then((function(e){if(e.errors)e.errors[0].detail?t.$message.error(e.errors[0].code+"\n"+e.errors[0].detail[0]):t.$message.error(e.errors[0].code),t.loginLoading=!1;else{var r=e.readdata.groups[0]._data.id;s.default.setLItem("username",e.data.attributes.username),"1"===r?(t.$router.push({path:"/admin"}),t.$message({message:"登录成功！",type:"success"}),t.loginLoading=!1):(t.$message.error("权限不足！"),t.loginLoading=!1)}})):e.errors&&(e.errors[0].detail?t.$message.error(e.errors[0].code+"\n"+e.errors[0].detail[0]):t.$message.error(e.errors[0].code),t.loginLoading=!1)}})).catch((function(e){e.errors&&(e.errors[0].detail?t.$message.error(e.errors[0].code+"\n"+e.errors[0].detail[0]):t.$message.error(e.errors[0].code),t.loginLoading=!1),t.loginLoading=!1}))}))},postLogin:function(){return this.appFetch({url:"login",method:"post",data:{data:{attributes:{username:this.form.user,password:this.form.password}}}}).then((function(e){return e})).catch((function(e){}))},getUserInfo:function(e){return this.appFetch({url:"users",method:"get",splice:"/"+e,data:{include:["groups"]}}).then((function(e){return e})).catch((function(e){}))}}),created:function(){var e=localStorage.getItem("access_token"),t=localStorage.getItem("user_id");localStorage.clear(),e&&localStorage.setItem("access_token",e),t&&localStorage.setItem("user_id",t)}}},"KHd+":function(e,t,r){"use strict";function o(e,t,r,o,n,s,a,i){var l,u="function"==typeof e?e.options:e;if(t&&(u.render=t,u.staticRenderFns=r,u._compiled=!0),o&&(u.functional=!0),s&&(u._scopeId="data-v-"+s),a?(l=function(e){(e=e||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext)||"undefined"==typeof __VUE_SSR_CONTEXT__||(e=__VUE_SSR_CONTEXT__),n&&n.call(this,e),e&&e._registeredComponents&&e._registeredComponents.add(a)},u._ssrRegister=l):n&&(l=i?function(){n.call(this,(u.functional?this.parent:this).$root.$options.shadowRoot)}:n),l)if(u.functional){u._injectStyles=l;var d=u.render;u.render=function(e,t){return l.call(t),d(e,t)}}else{var c=u.beforeCreate;u.beforeCreate=c?[].concat(c,l):[l]}return{exports:e,options:u}}r.d(t,"a",(function(){return o}))},LZXz:function(e,t,r){"use strict";r.r(t);var o=r("Tm62"),n=r.n(o);for(var s in o)["default"].indexOf(s)<0&&function(e){r.d(t,e,(function(){return o[e]}))}(s);t.default=n.a},Tm62:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=s(r("QbLZ")),n=s(r("Jmiy"));function s(e){return e&&e.__esModule?e:{default:e}}r("vP5V"),r("3Fxs"),t.default=(0,o.default)({name:"login-view"},n.default)},kBEJ:function(e,t,r){"use strict";r.d(t,"a",(function(){return o})),r.d(t,"b",(function(){return n}));var o=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"login-box"},[r("main",{staticClass:"login-main"},[e._m(0),e._v(" "),r("div",{staticClass:"login-main-form"},[r("el-form",{ref:"form",attrs:{model:e.form,rules:e.rules,"label-width":"0px"}},[r("el-form-item",{attrs:{prop:"user"}},[r("el-input",{attrs:{placeholder:"请输入用户名",clearable:""},model:{value:e.form.user,callback:function(t){e.$set(e.form,"user",t)},expression:"form.user"}},[r("span",{staticClass:"iconfont iconuser",attrs:{slot:"prefix"},slot:"prefix"})])],1),e._v(" "),r("el-form-item",{attrs:{prop:"password"}},[r("el-input",{attrs:{placeholder:"请输入密码",type:"password","show-password":"",clearable:""},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.adminLogin("form")}},model:{value:e.form.password,callback:function(t){e.$set(e.form,"password",t)},expression:"form.password"}},[r("span",{staticClass:"iconfont iconpassword",attrs:{slot:"prefix"},slot:"prefix"})])],1),e._v(" "),r("el-form-item",{staticClass:"login-main-form__item"}),e._v(" "),r("el-form-item",{staticClass:"login-main-form__item"},[r("el-button",{attrs:{type:"primary",loading:e.loginLoading},on:{click:function(t){return e.adminLogin("form")}}},[e._v("登录")])],1)],1)],1)]),e._v(" "),e._m(1)])},n=[function(){var e=this.$createElement,t=this._self._c||e;return t("header",{staticClass:"login-header"},[t("a",{attrs:{href:"/"}},[t("img",{attrs:{src:"/static-admin/images/logo.png",alt:"LOGO"}})])])},function(){var e=this.$createElement,t=this._self._c||e;return t("footer",{staticClass:"login-footer"},[t("p",[this._v("Powered by Discuz! Q")])])}]},rrzW:function(e,t,r){"use strict";r.r(t);var o=r("kBEJ"),n=r("LZXz");for(var s in n)["default"].indexOf(s)<0&&function(e){r.d(t,e,(function(){return n[e]}))}(s);var a=r("KHd+"),i=Object(a.a)(n.default,o.a,o.b,!1,null,null,null);t.default=i.exports},vP5V:function(e,t,r){}}]);