(window.webpackJsonp=window.webpackJsonp||[]).push([["pages-user-supple-mentary"],{"154b":function(e,t,i){"use strict";(function(e){var s;i.d(t,"b",(function(){return a})),i.d(t,"c",(function(){return n})),i.d(t,"a",(function(){return s}));try{s={quiPage:i("29c4").default,quiUploadFile:i("500f").default,quiIcon:i("895d").default,quiUploader:i("c012").default,uniPopup:i("1c89").default,quiToast:i("2039").default}}catch(t){if(-1===t.message.indexOf("Cannot find module")||-1===t.message.indexOf(".vue"))throw t;e.error(t.message),e.error("1. 排查组件名称拼写是否正确"),e.error("2. 排查组件是否符合 easycom 规范，文档：https://uniapp.dcloud.net.cn/collocation/pages?id=easycom"),e.error("3. 若组件不符合 easycom 规范，需手动引入，并在 components 中注册该组件")}var a=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("qui-page",{attrs:{"data-qui-theme":e.theme}},[i("v-uni-view",{staticClass:"supple-mentary"},[i("qui-upload-file",{directives:[{name:"show",rawName:"v-show",value:!1,expression:"false"}],ref:"uploadFiles",attrs:{url:e.url+"api/attachments",header:e.header,"login-status":e.loginStatus,"file-format":e.forums.set_attach&&e.forums.set_attach.support_file_ext,"file-size":e.forums.set_attach&&e.forums.set_attach.support_max_size},on:{change:function(t){arguments[0]=t=e.$handleEvent(t),e.fileChange.apply(void 0,arguments)},setToolTips:function(t){arguments[0]=t=e.$handleEvent(t),e.setToolTips.apply(void 0,arguments)}}}),e._l(e.dataList,(function(t,s){return i("v-uni-view",{key:s,staticClass:"supple-mentary-box"},[1===t.status?i("v-uni-view",{staticClass:"supple-mentary-box__title"},[e._v(e._s(s+1+"."+t.name)),1===t.status&&3===t.type?i("v-uni-text",{staticClass:"supple-mentary-box__title-checkdes"},[e._v(e._s(e.i18n.t("user.checkbox")))]):e._e(),1===t.required?i("v-uni-text",{staticClass:"supple-mentary-box__title-sign"},[e._v("*")]):e._e(),5===t.type?i("v-uni-view",{staticClass:"uploader-add",on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.uploadFileBtn(s)}}},[i("qui-icon",{attrs:{name:"icon-fujian",color:"#aaa",size:"36"}}),i("v-uni-view",{staticClass:"uploader-add__fonts"},[e._v(e._s(e.i18n.t("profile.uploadFile")))])],1):e._e()],1):e._e(),i("v-uni-view",{staticClass:"supple-mentary-box__con"},[1===t.status&&0===t.type?i("v-uni-input",{staticClass:"input",attrs:{maxlength:200,placeholder:e.i18n.t("user.pleaseEnterTheContent"),"placeholder-style":"color: #ddd"},model:{value:t.fields_detail,callback:function(i){e.$set(t,"fields_detail",i)},expression:"item.fields_detail"}}):e._e(),1===t.status&&1===t.type?i("v-uni-textarea",{staticClass:"textarea",attrs:{"placeholder-class":"textarea-placeholder",placeholder:e.i18n.t("user.pleaseEnterTheContent"),"placeholder-style":"color: #ddd",maxlength:500},model:{value:t.fields_detail,callback:function(i){e.$set(t,"fields_detail",i)},expression:"item.fields_detail"}}):e._e(),1===t.status&&2===t.type?i("v-uni-radio-group",{on:{change:function(t){arguments[0]=t=e.$handleEvent(t),e.radioChange.apply(void 0,arguments)}}},e._l(t.fields_options.options,(function(t,a){return i("v-uni-label",{key:a,staticClass:"supple-mentary-box__con-item"},[i("v-uni-view",[i("v-uni-radio",{attrs:{value:t.value+"-"+s}})],1),i("v-uni-view",{staticClass:"item-name"},[e._v(e._s(t.value))])],1)})),1):e._e(),1===t.status&&3===t.type?i("v-uni-checkbox-group",{on:{change:function(t){arguments[0]=t=e.$handleEvent(t),e.checkboxChange.apply(void 0,arguments)}}},e._l(t.fields_options.options,(function(t,a){return i("v-uni-label",{key:a,staticClass:"supple-mentary-box__con-item"},[i("v-uni-view",[i("v-uni-checkbox",{attrs:{value:t.value+"-"+s}})],1),i("v-uni-view",{staticClass:"item-name"},[e._v(e._s(t.value))])],1)})),1):e._e(),1===t.status&&4===t.type?i("v-uni-view",[i("qui-uploader",{ref:"upload-"+s,refInFor:!0,attrs:{url:e.url+"api/attachments","form-data":e.formData,"file-preview":e.filePreview,"delete-type":0,"extend-index":s,"login-status":e.loginStatus,name:"file","async-clear":!0},on:{change:function(t){arguments[0]=t=e.$handleEvent(t),e.uploadChange.apply(void 0,arguments)},clear:function(t){arguments[0]=t=e.$handleEvent(t),e.uploadClear.apply(void 0,arguments)},uploadClick:function(t){arguments[0]=t=e.$handleEvent(t),e.uploadClick.apply(void 0,arguments)}}})],1):e._e(),1===t.status&&5===t.type?i("v-uni-view",[t.fields_detail.length>0?i("v-uni-view",{staticClass:"file-box"},e._l(t.fields_detail,(function(t,a){return i("v-uni-view",{key:a,staticClass:"file-box__item"},[i("v-uni-view",{staticClass:"attachment-name"},[i("qui-icon",{staticClass:"icon-attachment",attrs:{name:t.name?"icon-"+t.format:"icon-resources",size:"22"}}),i("v-uni-text",[e._v(e._s(t.name))]),i("qui-icon",{staticClass:"icon-shanchu",attrs:{name:"icon-shanchu",color:"#FB7474",size:"22"},on:{click:function(i){arguments[0]=i=e.$handleEvent(i),e.deleteFile(t.id,s)}}})],1)],1)})),1):e._e()],1):e._e()],1)],1)})),i("v-uni-view",{staticClass:"supple-mentary-btn",on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.handleRegister.apply(void 0,arguments)}}},[e._v(e._s(e.i18n.t("user.register")))])],2),i("uni-popup",{ref:"deletePopup",attrs:{type:"center"}},[i("uni-popup-dialog",{attrs:{type:"warn",content:e.deleteTip,"before-close":!0},on:{close:function(t){arguments[0]=t=e.$handleEvent(t),e.handleDeleteCancel.apply(void 0,arguments)},confirm:function(t){arguments[0]=t=e.$handleEvent(t),e.handleDeleteOk.apply(void 0,arguments)}}})],1),i("qui-toast",{ref:"toast"})],1)},n=[]}).call(this,i("5a52").default)},"245f":function(e,t,i){"use strict";(function(t){var s=i("4ea4").default,a=s(i("6f74")),n=i("b95e"),o=s(i("4c82"));e.exports={mixins:[a.default,o.default],methods:{getForum:function(){var e=this;this.$store.dispatch("jv/get",["forum",{params:{include:"users"}}]).then((function(t){t&&(e.forum=t)}))},jump2PhoneLoginPage:function(){uni.redirectTo({url:"/pages/user/phone-login"})},jump2PhoneLoginRegisterPage:function(){uni.redirectTo({url:"/pages/user/phone-login-register"})},jump2LoginPage:function(){uni.navigateTo({url:"/pages/user/login"})},jump2RegisterPage:function(){uni.redirectTo({url:"/pages/user/register"})},jump2RegisterExtendPage:function(){uni.redirectTo({url:"/pages/user/supple-mentary"})},jump2LoginBindPage:function(){uni.redirectTo({url:"/pages/user/login-bind"})},jump2RegisterBindPage:function(){uni.redirectTo({url:"/pages/user/register-bind"})},jump2LoginBindPhonePage:function(){uni.redirectTo({url:"/pages/user/login-bind-phone"})},jump2RegisterBindPhonePage:function(){uni.redirectTo({url:"/pages/user/register-bind-phone"})},jump2findpwdPage:function(){uni.navigateTo({url:"/pages/modify/findpwd?pas=reset_pwd"})},mpLoginMode:function(){this.forums&&this.forums.set_reg&&0===this.forums.set_reg.register_type&&this.jump2LoginPage(),this.forums&&this.forums.set_reg&&1===this.forums.set_reg.register_type&&this.jump2PhoneLoginRegisterPage(),this.forums&&this.forums.set_reg&&2===this.forums.set_reg.register_type&&(uni.setStorageSync("register",1),uni.setStorageSync("isSend",!0),this.$store.getters["session/get"]("auth").open())},h5LoginMode:function(){o.default.isWeixin().isWeixin?(this.forums&&this.forums.set_reg&&0===this.forums.set_reg.register_type&&uni.navigateTo({url:"/pages/user/login"}),this.forums&&this.forums.set_reg&&1===this.forums.set_reg.register_type&&this.jump2PhoneLoginRegisterPage(),this.forums&&this.forums.set_reg&&2===this.forums.set_reg.register_type&&(uni.setStorageSync("register",1),this.$store.dispatch("session/wxh5Login"))):(this.forums&&this.forums.set_reg&&0===this.forums.set_reg.register_type&&uni.navigateTo({url:"/pages/user/login"}),this.forums&&this.forums.set_reg&&1===this.forums.set_reg.register_type&&this.jump2PhoneLoginRegisterPage(),this.forums&&this.forums.set_reg&&2===this.forums.set_reg.register_type&&uni.navigateTo({url:"/pages/user/login"}))},refreshmpParams:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:function(){};e()},mpLogin:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;uni.setStorageSync("register",e),uni.setStorageSync("isSend",!0),this.$store.getters["session/get"]("auth").open()},wxh5Login:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;uni.setStorageSync("register",e),uni.setStorageSync("rebind",t),uni.setStorageSync("h5_wechat_login",1),this.$store.dispatch("session/wxh5Login")},getLoginParams:function(e,t){var i=e;if(""===e.data.attributes.username)uni.showToast({icon:"none",title:this.i18n.t("user.usernameEmpty"),duration:2e3});else if(""===e.data.attributes.password)uni.showToast({icon:"none",title:this.i18n.t("user.passwordEmpty"),duration:2e3});else{var s=uni.getStorageSync("token");""!==s&&(i.data.attributes.token=s),this.login(i,t)}},getLoginBindParams:function(e,t){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;this.refreshmpParams();var s=e;if(""===e.data.attributes.username)uni.showToast({icon:"none",title:this.i18n.t("user.usernameEmpty"),duration:2e3});else if(""===e.data.attributes.password)uni.showToast({icon:"none",title:this.i18n.t("user.passwordEmpty"),duration:2e3});else{1===i&&(s.data.attributes.rebind=1);var a=uni.getStorageSync("token");""!==a&&(s.data.attributes.token=a),this.login(s,t)}},login:function(e,i){var s=this;this.$store.dispatch("session/h5Login",e).then((function(e){if(e&&e.data&&e.data.data&&e.data.data.id&&(s.logind(),s.$store.dispatch("jv/get",["forum",{params:{include:"users"}}]).then((function(e){e&&e.set_site&&e.set_site.site_mode!==n.SITE_PAY&&uni.getStorage({key:"page",success:function(e){uni.redirectTo({url:e.data})}}),e&&e.set_site&&e.set_site.site_mode===n.SITE_PAY&&s.user&&!s.user.paid&&uni.redirectTo({url:"/pages/site/info"})})),uni.showToast({title:i,duration:2e3})),e&&e.data&&e.data.errors){if("401"===e.data.errors[0].status||"402"===e.data.errors[0].status||"500"===e.data.errors[0].status){var t=s.i18n.t("core.".concat(e.data.errors[0].code));uni.showToast({icon:"none",title:t,duration:2e3})}if("403"===e.data.errors[0].status||"422"===e.data.errors[0].status){var a=s.i18n.t("core.".concat(e.data.errors[0].code))||s.i18n.t(e.data.errors[0].detail[0]);uni.showToast({icon:"none",title:a,duration:2e3})}}})).catch((function(e){return t.log(e)}))}}}}).call(this,i("5a52").default)},"368d":function(e,t,i){e.exports=i.p+"static/img/msg-warning.f35ce51f.svg"},"39c6":function(e,t,i){"use strict";var s=i("dda8");i.n(s).a},"588d":function(e,t,i){"use strict";i.r(t);var s=i("b880"),a=i.n(s);for(var n in s)["default"].indexOf(n)<0&&function(e){i.d(t,e,(function(){return s[e]}))}(n);t.default=a.a},"6f74":function(e,t,i){"use strict";var s=i("b95e");e.exports={computed:{user:function(){var e=this.$store.getters["session/get"]("userId");return e?this.$store.getters["jv/get"]("users/".concat(e)):{}}},methods:{getUserInfo:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=(new Date).getTime(),i=uni.getStorageSync(s.STORGE_GET_USER_TIME);if(e||(t-i)/1e3>60){var a={include:"groups,wechat"},n=this.$store.getters["session/get"]("userId");this.$store.commit("jv/deleteRecord",{_jv:{type:"users",id:n}}),this.$store.dispatch("jv/get",["users/".concat(n),{params:a}]).then((function(){return uni.$emit("updateNotiNum")})),uni.setStorageSync(s.STORGE_GET_USER_TIME,(new Date).getTime())}},logind:function(){var e=this,t=this.$store.getters["session/get"]("userId");if(t){this.$store.dispatch("jv/get",["forum",{params:{include:"users"}}]);this.$store.dispatch("jv/get",["users/".concat(t),{params:{include:"groups,wechat"}}]).then((function(t){e.$u.event.$emit("logind",t)})),this.$store.dispatch("forum/setError",{loading:!1})}}}}},a0b8:function(e,t,i){"use strict";var s=i("154b");i.d(t,"a",(function(){return s.a})),i.d(t,"b",(function(){return s.b})),i.d(t,"c",(function(){return s.c}))},b02e:function(e,t,i){(t=i("24fb")(!1)).push([e.i,'@charset "UTF-8";\n/**\n * 这里是uni-app内置的常用样式变量\n *\n * uni-app 官方扩展插件及插件市场（https://ext.dcloud.net.cn）上很多三方插件均使用了这些样式变量\n * 如果你是插件开发者，建议你使用scss预处理，并在插件代码中直接使用这些变量（无需 import 这个文件），方便用户通过搭积木的方式开发整体风格一致的App\n *\n */\n/**\n * 如果你是App开发者（插件使用者），你可以通过修改这些变量来定制自己的插件主题，实现自定义主题功能\n *\n * 如果你的项目同样使用了scss预处理，你也可以直接在你的 scss 代码中使用如下变量，同时无需 import 这个文件\n */\n/* 颜色变量 */\n/* 行为相关颜色 */\n/* 文字基本颜色 */\n/* 背景颜色 */\n/* 边框颜色 */\n/* 尺寸变量 */\n/* 文字尺寸 */\n/* 图片尺寸 */\n/* Border Radius */\n/* 水平间距 */\n/* 垂直间距 */\n/* 透明度 */\n/* 文章场景相关 */\n/* eg:\n  .container {\n    color: --color(BG-1);\n  }\n*/.qui-page[data-v-3c1c19bc]{background-color:var(--qui-BG-2)}.supple-mentary[data-v-3c1c19bc]{padding:%?40?% 0 %?20?%;background-color:var(--qui-BG-2)}.supple-mentary-btn[data-v-3c1c19bc]{width:%?670?%;height:%?90?%;margin:%?50?% auto %?60?%;line-height:%?90?%;color:var(--qui-FC-FFF);text-align:center;background-color:var(--qui-MAIN);border-radius:%?5?%}.supple-mentary-box[data-v-3c1c19bc]{padding:%?0?% %?30?%;font-size:%?28?%}.supple-mentary-box__title[data-v-3c1c19bc]{position:relative;display:-webkit-box;display:-webkit-flex;display:flex;line-height:%?60?%;color:#999;-webkit-box-align:center;-webkit-align-items:center;align-items:center}.supple-mentary-box__title-checkdes[data-v-3c1c19bc]{margin-left:%?15?%;color:#2699fb}.supple-mentary-box__title-sign[data-v-3c1c19bc]{margin-left:%?10?%;color:#f12c20}.supple-mentary-box__con[data-v-3c1c19bc]{color:var(--qui-FC-333)}.supple-mentary-box__con-item[data-v-3c1c19bc]{display:-webkit-box;display:-webkit-flex;display:flex;font-size:%?32?%;line-height:%?80?%}.supple-mentary-box__con-item .item-name[data-v-3c1c19bc]{margin-left:%?15?%}.supple-mentary-box__con .input[data-v-3c1c19bc]{padding:%?20?%;border:%?2?% solid var(--qui-BOR-DDD);border-radius:%?10?%}.supple-mentary-box__con .textarea[data-v-3c1c19bc]{width:100%;padding:%?20?%;border:%?2?% solid var(--qui-BOR-DDD);border-radius:%?10?%;box-sizing:border-box}.supple-mentary-box .uploader-add[data-v-3c1c19bc]{position:absolute;right:%?15?%;display:-webkit-box;display:-webkit-flex;display:flex}.file-box[data-v-3c1c19bc]{margin-top:%?20?%;margin-bottom:%?20?%}.file-box__item[data-v-3c1c19bc]{position:relative;height:%?60?%;padding:0 %?20?%;margin-bottom:%?10?%;overflow:hidden;font-size:%?24?%;line-height:%?60?%;border:%?2?% solid var(--qui-BOR-ED);border-radius:%?5?%;box-sizing:border-box}.file-box .attachment-name[data-v-3c1c19bc]{max-width:100%;padding-right:%?40?%;overflow:hidden;font-size:%?26?%;text-overflow:ellipsis;white-space:nowrap}.file-box .icon-attachment[data-v-3c1c19bc]{margin-right:%?10?%}.file-box .icon-shanchu[data-v-3c1c19bc]{position:absolute;right:%?20?%;font-weight:700}',""]),e.exports=t},b469:function(e,t){e.exports={computed:{forums:function(){return this.$store.getters["jv/get"]("forums/1")}}}},b880:function(e,t,i){"use strict";var s=i("4ea4").default;Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,i("ac1f"),i("1276"),i("a9e3"),i("4160"),i("159b"),i("d81d"),i("c975"),i("a434"),i("baa5"),i("4e82");var a=s(i("6f74")),n=i("b95e"),o=s(i("b469")),r={components:{uniPopupDialog:s(i("840a")).default},mixins:[a.default,o.default],data:function(){return{dataList:[],url:n.DISCUZ_REQUEST_HOST,formData:{type:1},filePreview:[],uploadStatus:!0,deleteType:"",deleteTip:"",deleteId:"",deleteIndex:"",extendIndex:"",loginStatus:0,header:{}}},computed:{userId:function(){return this.$store.getters["session/get"]("userId")}},mounted:function(){var e=uni.getStorageSync("access_token");this.header={authorization:"Bearer ".concat(e)},this.getData()},methods:{radioChange:function(e){var t=e.target.value.split("-"),i=this.dataList[Number(t[1])];i.fields_detail=i.fields_options,i.fields_detail.options.forEach((function(e,s){e.value===t[0]?i.fields_detail.options[s].checked=!0:i.fields_detail.options[s].checked=!1}))},checkboxChange:function(e){var t=e.target.value,i=Number(t[0].split("-")[1]),s=t.map((function(e){return e.split("-")[0]})),a=this.dataList[i];a.fields_detail=a.fields_options,a.fields_detail.options.forEach((function(e,t){-1!==s.indexOf(e.value)?a.fields_detail.options[t].checked=!0:a.fields_detail.options[t].checked=!1}))},uploadClick:function(e){this.uploadStatus=e},uploadChange:function(e,t,i){this.uploadStatus=t,this.dataList[i].fields_detail=e},uploadClear:function(e,t,i){this.deleteType=0,this.deleteId=e.id,this.deleteIndex=t,this.extendIndex=i,this.$refs.deletePopup.open(),this.deleteTip=this.i18n.t("core.deleteImgSure")},handleDeleteCancel:function(){this.$refs.deletePopup.close()},handleDeleteOk:function(){var e=this;if(this.$refs.deletePopup.close(),0===this.deleteType){var t=this.dataList[this.extendIndex].fields_detail;t.forEach((function(i,s){e.deleteId===i.id&&t.splice(s,1)})),this.$refs["upload-".concat(this.extendIndex)][0].clear(this.deleteIndex)}else{var i=this.dataList[this.extendIndex].fields_detail;i.forEach((function(t,s){e.deleteId===t.id&&(i.splice(s,1),e.$refs.uploadFiles.deleteItem(t.id))}))}},uploadFileBtn:function(e){this.$refs.uploadFiles.uploadBtn(),this.$refs.uploadFiles.setIndex(e)},fileChange:function(e){var t=this,i=e;this.dataList.forEach((function(e,i){5===e.type&&(t.dataList[i].fields_detail=[])})),i.forEach((function(e){t.dataList[e.index].fields_detail.push({id:e.id,name:e.attributes.fileName,url:e.attributes.url,format:e.attributes.fileName.substring(e.attributes.fileName.lastIndexOf(".")+1).toUpperCase()})}))},deleteFile:function(e,t){this.deleteType=1,this.deleteId=e,this.extendIndex=t,this.$refs.deletePopup.open(),this.deleteTip=this.i18n.t("core.deleteEnclosureSure")},setToolTips:function(e){this.$refs.toast.show({message:e})},getData:function(){var e=this,t={user_id:this.userId};this.$store.dispatch("jv/get",["user/signinfields",{params:t}]).then((function(t){var i=t;i.forEach((function(e){var t=e;2!==e.type&&3!==e.type||(t.fields_options=JSON.parse(e.fields_ext)),e.type>1?t.fields_detail=[]:t.fields_detail=""})),e.dataList=i}))},submitData:function(){var e=this,t={data:[]};this.dataList.forEach((function(i){var s=i;if(0===i.type||1===i.type)s.fields_ext=i.fields_detail;else if(2===i.type||3===i.type)s.fields_ext=JSON.stringify(i.fields_detail);else if(4===i.type)if(i.fields_detail.length>0){var a=[];i.fields_detail.forEach((function(e){a.push({id:e.id,name:e.attributes.fileName,url:e.attributes.url})})),s.fields_ext=JSON.stringify(a)}else s.fields_ext="";else s.fields_ext=i.fields_detail.length>0?JSON.stringify(i.fields_detail):"";t.data.push({type:"user_sign_in",attributes:{name:i.name,id:i.id,user_id:e.userId,type:i.type,sort:i.sort,fields_desc:i.fields_desc,required:i.required,fields_ext:i.fields_ext,status:i.status}})})),this.$store.dispatch("jv/post",[{_jv:{type:"user/signinfields"}},{data:t}]).then((function(){e.logind(),uni.redirectTo({url:"/pages/home/index"})}))},handleRegister:function(){for(var e=[],t=/^\s*$/g,i=0;i<this.dataList.length;i+=1){if(1===this.dataList[i].required&&(t.test(this.dataList[i].fields_detail)||this.dataList[i].fields_detail.length<1))return this.$refs.toast.show({message:"".concat(this.dataList[i].name,"不能为空")}),void e.push(0);e.push(1)}-1===e.indexOf(0)&&this.submitData()}}};t.default=r},dda8:function(e,t,i){var s=i("b02e");"string"==typeof s&&(s=[[e.i,s,""]]),s.locals&&(e.exports=s.locals);(0,i("4f06").default)("5d2d5863",s,!0,{sourceMap:!1,shadowMode:!1})},e972:function(e,t,i){e.exports=i.p+"static/img/msg-404.3ba2611f.svg"},f6fb:function(e,t,i){"use strict";i.r(t);var s=i("a0b8"),a=i("588d");for(var n in a)["default"].indexOf(n)<0&&function(e){i.d(t,e,(function(){return a[e]}))}(n);i("39c6");var o=i("f0c5"),r=Object(o.a)(a.default,s.b,s.c,!1,null,"3c1c19bc",null,!1,s.a,void 0);t.default=r.exports}}]);