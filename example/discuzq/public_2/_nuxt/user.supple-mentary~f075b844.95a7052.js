(window.webpackJsonp=window.webpackJsonp||[]).push([[60],{1036:function(t,e,r){},1169:function(t,e,r){"use strict";r(1036)},1260:function(t,e,r){"use strict";r.r(e);var n=r(27),head=(r(45),r(63),r(159),r(25),r(716)),o=r.n(head),c=r(715),d=r.n(c),l=r(158),f=r.n(l),m={name:"SuppleMentary",mixins:[o.a,d.a,f.a],data:function(){return{title:this.$t("user.supplementary"),loading:!1,onUploadImage:!1,id:"",onUploadAttached:!1,dataList:[],isSubmit:!1,site_mode:"",isPaid:""}},computed:{forums:function(){return this.$store.state.site.info.attributes||{}},url:function(){return"/api"},imageTypeLimit:function(){return this.forums.set_attach?this.forums.set_attach.support_img_ext.split(",").map((function(t){return".".concat(t)})).join(","):""},attachedTypeLimit:function(){return this.forums.set_attach?this.forums.set_attach.support_file_ext.split(",").map((function(t){return".".concat(t)})).join(","):""},attachedSizeLimit:function(){return this.forums.set_attach?1024*this.forums.set_attach.support_max_size*1024:10485760}},mounted:function(){var t=this.$route.query.id;t&&(this.id=t),this.forums&&this.forums.set_site&&this.forums.set_site.site_mode&&(this.site_mode=this.forums.set_site.site_mode),this.getData()},methods:{registerConfirm:function(){this.isSubmit=!0;for(var t=this.dataList,i=0;i<t.length;i++)if(t[i].required){var e=new RegExp("^[ ]+$"),r=t[i].detail;if(!r||r.length<1||e.test(r))return this.$message.error("".concat(t[i].name,"不能为空")),"string"==typeof r&&(this.dataList[i].detail=""),void(this.isSubmit=!1)}this.submit()},onPostContentChange:function(t,e,r){var n=this;1===e.length?this.dataList[r].detail.push(e[0]):e.forEach((function(t){n.dataList[r].detail.push(t)}))},removeItem:function(t,e){this.dataList[e].detail.splice(t,1)},submit:function(){var t=this;this.isSubmit=!0;var e=this.dataList,r={data:[]};e.forEach((function(e){var o=Object(n.a)(e.detail),c="";2===e.type?(e.options.forEach((function(t){t.value===e.detail.value&&(t.checked=!0)})),c=JSON.stringify({options:e.options})):3===e.type?(e.options.forEach((function(t){-1!==e.detail.indexOf(t.value)&&(t.checked=!0)})),c=JSON.stringify({options:e.options})):c="string"===o?e.detail:JSON.stringify(e.detail),r.data.push({type:"user_sign_in",attributes:{sort:e.sort,name:e.name,id:e.id,user_id:t.id,type:e.type,fields_desc:e.fields_desc,type_desc:e.type_desc,required:e.required,fields_ext:c,remark:e.remark,status:e.status}})})),this.$store.dispatch("jv/post",[{_jv:{type:"user/signinfields"}},{data:r}]).then((function(data){t.getUserInfo()}))},getUserInfo:function(){var t=this,e=this.$store.getters["session/get"]("userId");this.$store.dispatch("jv/get",["users/".concat(e),{params:{include:"groups"}}]).then((function(e){e&&e.paid&&(t.isPaid=e.paid),""===t.site_mode?window.location.href="/":("pay"!==t.site_mode||t.isPaid)&&(t.isSubmit=!1,t.$router.push("/")),"pay"!==t.site_mode||t.isPaid||(t.isSubmit=!1,t.$router.push("/site/info"))})).catch((function(e){var r=e.response.data.errors;if(Array.isArray(r)&&r.length>0&&"register_validate"===r[0].code)return t.$store.commit("session/SET_AUDIT_INFO",{errorCode:"register_validate",username:r[0].data.userName}),void t.$router.push("/user/warning")}))},getData:function(){var t=this,e={user_id:this.id};this.$store.dispatch("jv/get",["user/signinfields",{params:e}]).then((function(e){e.forEach((function(t,i){!t.fields_ext||2!==t.type&&3!==t.type||(t.options=JSON.parse(t.fields_ext).options),t.detail=t.type>2?[]:""})),t.dataList=e}),(function(e){return t.handleError(e)}))}}},h=(r(1169),r(11)),component=Object(h.a)(m,(function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"supple"},[r("h2",{staticClass:"supple-title"},[t._v(t._s(t.$t("user.supplementary")))]),t._v(" "),t._l(t.dataList,(function(e,n){return r("div",{key:n,staticClass:"supple-content"},[r("div",{staticClass:"supple-content__item"},[r("div",{staticClass:"supple-content__item__title"},[t._v("\n        "+t._s(n+1+"."+e.name)+"\n        "),e.required?r("span",{staticClass:"supple-content__item__title-necessary"},[t._v("*\n        ")]):t._e()]),t._v(" "),r("div",{staticClass:"supple-content__item__detail"},[0===e.type?r("el-input",{attrs:{clearable:"",placeholder:t.$t("user.inputcontent")},model:{value:e.detail,callback:function(r){t.$set(e,"detail",r)},expression:"item.detail"}}):1===e.type?r("el-input",{attrs:{clearable:"",type:"textarea",autosize:{minRows:2,maxRows:4},placeholder:t.$t("user.inputcontent")},model:{value:e.detail,callback:function(r){t.$set(e,"detail",r)},expression:"item.detail"}}):2===e.type?r("el-radio-group",{model:{value:e.detail,callback:function(r){t.$set(e,"detail",r)},expression:"item.detail"}},t._l(e.options,(function(e){return r("el-radio",{key:e.value,attrs:{label:e}},[t._v(t._s(e.value)+"\n          ")])})),1):3===e.type?r("el-checkbox-group",{model:{value:e.detail,callback:function(r){t.$set(e,"detail",r)},expression:"item.detail"}},t._l(e.options,(function(t){return r("el-checkbox",{key:t.value,attrs:{label:t.value}})})),1):4===e.type?r("div",{staticClass:"supple-content__item__detail-image"},[r("image-upload",{attrs:{"on-upload":t.onUploadImage,type:1,"file-list":[],action:"/attachments",accept:t.imageTypeLimit,"size-limit":t.attachedSizeLimit},on:{"update:onUpload":function(e){t.onUploadImage=e},"update:on-upload":function(e){t.onUploadImage=e},success:function(e){return t.onPostContentChange("imageList",e,n)},remove:function(e,r){return t.removeItem(r,n)}}})],1):5===e.type?r("div",{staticClass:"supple-content__item__detail-file"},[r("attachment-upload",{attrs:{"file-list":[],"on-upload":t.onUploadAttached,action:"/attachments",accept:t.attachedTypeLimit,type:0,"size-limit":t.attachedSizeLimit,"add-tips":t.$t("post.postAttachment")},on:{"update:onUpload":function(e){t.onUploadAttached=e},"update:on-upload":function(e){t.onUploadAttached=e},success:function(e){return t.onPostContentChange("attachedList",e,n)},remove:function(e,r){return t.removeItem(r,n)}}})],1):t._e()],1)])])})),t._v(" "),r("el-button",{staticClass:"r-button",attrs:{type:"primary",disabled:t.isSubmit},on:{click:t.registerConfirm}},[t._v("\n    "+t._s(t.$t("modify.submit"))+"\n  ")])],2)}),[],!1,null,"4ca4e07e",null);e.default=component.exports;installComponents(component,{ImageUpload:r(870).default,AttachmentUpload:r(869).default})},715:function(t,e,r){var n=r(728);r(31),r(52),t.exports={data:function(){var t=this;return{errorCodeHandler:{default:{model_not_found:function(){return t.$router.replace("/error")},not_authenticated:function(){return t.$router.push("/user/login")}},thread:{permission_denied:function(){return t.$router.replace("/error?code=permissionDenied")}}}}},methods:{handleError:function(t){var e=arguments,r=this;return n(regeneratorRuntime.mark((function n(){var o,c,d,l,f,m;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(o=e.length>1&&void 0!==e[1]?e[1]:"",c=t.response.data.errors,!(Array.isArray(c)&&c.length>0)){n.next=17;break}if(d=c[0].code,l=c[0].detail&&c[0].detail.length>0?c[0].detail[0]:c[0].code,f=c[0].detail&&c[0].detail.length>0?c[0].detail[0]:r.$t("core.".concat(l)),"site_closed"!==c[0].code){n.next=10;break}return n.next=9,r.siteClose(c);case 9:return n.abrupt("return",n.sent);case 10:if("need_ext_fields"!==c[0].code){n.next=14;break}return m=r.$store.getters["session/get"]("userId"),r.$router.push("/user/supple-mentary?id=".concat(m)),n.abrupt("return");case 14:"Permission Denied"===d?r.$message.error(r.$t("core.permission_denied2")):"content_banned_show_words"===d?r.$message.error(r.$t("core.content_banned_show_words")+c[0].detail):r.$message.error(f),r.errorCodeHandler.default[d]&&r.errorCodeHandler.default[d](),o&&r.errorCodeHandler[o][d]&&r.errorCodeHandler[o][d]();case 17:case"end":return n.stop()}}),n)})))()},siteClose:function(t){var e=this;return n(regeneratorRuntime.mark((function r(){return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.prev=0,r.next=3,e.$store.dispatch("forum/setError",{code:t[0].code,detail:t[0].detail&&t[0].detail.length>0&&t[0].detail[0]});case 3:return r.next=5,e.$router.push("/site/close");case 5:r.next=9;break;case 7:r.prev=7,r.t0=r.catch(0);case 9:case"end":return r.stop()}}),r,null,[[0,7]])})))()}}}},716:function(t,e){t.exports={data:function(){return{title:"‎"}},computed:{forums:function(){return this.$store.state.site.info.attributes||{}}},head:function(){return{title:"‎"!==this.title&&this.forums&&this.forums.set_site&&this.forums.set_site.site_name?"".concat(this.title," - ").concat(this.forums.set_site.site_name):this.title}}}},728:function(t,e){function r(t,e,r,n,o,c,d){try{var l=t[c](d),f=l.value}catch(t){return void r(t)}l.done?e(f):Promise.resolve(f).then(n,o)}t.exports=function(t){return function(){var e=this,n=arguments;return new Promise((function(o,c){var d=t.apply(e,n);function l(t){r(d,o,c,l,f,"next",t)}function f(t){r(d,o,c,l,f,"throw",t)}l(void 0)}))}},t.exports.default=t.exports,t.exports.__esModule=!0},734:function(t,e){e.extensionList=["7Z","AI","APK","CAD","CDR","DOC","DOCX","EPS","EXE","IPA","MP3","MP4","PDF","PPT","PSD","RAR","TXT","XLS","XLSX","ZIP","JPG","WAV"]},798:function(t,e,r){var n=r(874),o=r(875),c=r(876),d=r(877);t.exports=function(t){return n(t)||o(t)||c(t)||d()},t.exports.default=t.exports,t.exports.__esModule=!0},802:function(t,e){t.exports=function(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,r=new Array(e);i<e;i++)r[i]=t[i];return r},t.exports.default=t.exports,t.exports.__esModule=!0},874:function(t,e,r){var n=r(802);t.exports=function(t){if(Array.isArray(t))return n(t)},t.exports.default=t.exports,t.exports.__esModule=!0},875:function(t,e){t.exports=function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)},t.exports.default=t.exports,t.exports.__esModule=!0},876:function(t,e,r){var n=r(802);t.exports=function(t,e){if(t){if("string"==typeof t)return n(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?n(t,e):void 0}},t.exports.default=t.exports,t.exports.__esModule=!0},877:function(t,e){t.exports=function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")},t.exports.default=t.exports,t.exports.__esModule=!0}}]);