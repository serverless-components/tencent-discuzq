(window.webpackJsonp=window.webpackJsonp||[]).push([[50],{AWfW:function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=o(s("gDS+")),n=o(s("4gYi")),r=o(s("kAKY"));function o(t){return t&&t.__esModule?t:{default:t}}e.default={data:function(){return{groupsList:[],options:[{value:0,label:"单行文本框"},{value:1,label:"多行文本框"},{value:2,label:"单选"},{value:3,label:"复选"},{value:4,label:"图片上传"},{value:5,label:"附件上传"}],value:"",textarea:"",arr:[],stry:"",visible:!1,dataList:[],arrsLiist:[]}},created:function(){this.extendedFields()},methods:{extendedFields:function(){var t=this;this.appFetch({url:"signInFields",method:"get",data:{}}).then((function(e){t.informationList(e.data)}))},informationList:function(t){this.groupsList=[];for(var e=0;e<t.length;e++){var s={name:t[e].attributes.name,id:t[e].attributes.id,content:"",description:t[e].attributes.type,sort:t[e].attributes.sort,introduce:t[e].attributes.fields_desc,enable:1===t[e].attributes.status,required:1===t[e].attributes.required},i="";if(t[e].attributes.fields_ext&&(i=JSON.parse(t[e].attributes.fields_ext)),i.options){for(var n=i.options,r=0;r<n.length;r++)s.content+=n[r].value+"\n";this.groupsList.push(s)}else s.content="",this.groupsList.push(s)}this.orderList()},orderList:function(){this.groupsList.sort(this.soreoder("sort"))},soreoder:function(t){return function(e,s){return e[t]-s[t]}},changInput:function(t){""===t||this.isNumber(t)||this.$message.error("请输入整数")},isNumber:function(t){return null!=/^(-)?\d+(\.\d+)?$/.exec(t)},obtainValue:function(t){this.value=t},handleSelectionChange:function(t){var e=this;this.arrsLiist=[],t.forEach((function(t,s){var i={attributes:{status:0}};if(t.newly){[].push(t)}else i.attributes.id=t.id,e.arrsLiist.push(i)}))},deleteList:function(){var t=this;this.appFetch({url:"signInFields",method:"post",data:{data:this.arrsLiist}}).then((function(e){e.errors?t.$message.error(e.errors[0].code):(t.$message({message:"删除成功",type:"success"}),t.extendedFields())}))},deleteField:function(t){var e=this;this.appFetch({url:"signInFields",method:"post",data:{data:{attributes:{id:t.row.id,status:0}}}}).then((function(t){t.errors?e.$message.error(t.errors[0].code):(e.$message({message:"删除成功",type:"success"}),e.extendedFields())}))},operationDelete:function(t){var e=this;this.$confirm("删除后，则此字段及其历史用户信息，将从系统中彻底删除，且无法恢复，请谨慎操作，点击确认删除，则删除",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){t.row.newly?e.groupsList.splice(t.$index,1):(e.groupsList.splice(t.$index,1),e.deleteField(t))})).catch((function(){e.$message({type:"info",message:"已取消删除"})}))},increaseList:function(){this.groupsList.push({name:"",id:"",content:"",description:"",sort:"",introduce:"",enable:!1,required:!1,newly:1})},submitClick:function(){this.dataList=[];for(var t=0;t<this.groupsList.length;t++){var e={type:"admin_sign_in",attributes:{name:this.groupsList[t].name,type:this.groupsList[t].description,fields_desc:this.groupsList[t].introduce,sort:this.groupsList[t].sort,status:this.groupsList[t].enable?1:-1,required:this.groupsList[t].required?1:0}};if(this.groupsList[t].id&&(e.attributes.id=this.groupsList[t].id),this.groupsList[t].content){for(var s=this.groupsList[t].content.split(/\n/),n=0;n<s.sort().length;n++)""!==s[n].trim()&&this.arr.push({value:s[n].trim(),checked:!1});var r={options:this.arr};e.attributes.fields_ext=(0,i.default)(r),this.dataList.push(e)}else e.attributes.fields_ext="",this.dataList.push(e);this.arr=[]}this.addRegistration(this.dataList)},testDataRun:function(){var t=this,e=!0;return this.groupsList.forEach((function(s){return""===s.name?(t.$message.error("字段名称未填写"),void(e=!1)):""===s.description?(t.$message.error("字段类型未填写"),void(e=!1)):2!==s.description&&3!==s.description||""!==s.content?""===s.sort?(t.$message.error("字段排序未填写"),void(e=!1)):void 0:(t.$message.error("字段选项未填写"),void(e=!1))})),e},addRegistration:function(t){var e=this;this.testDataRun()&&this.appFetch({url:"signInFields",method:"post",data:{data:t}}).then((function(t){t.errors?e.$message.error(t.errors[0].code):(e.$message({message:"操作成功",type:"success"}),e.extendedFields())}))},submitDetele:function(){var t=this;this.arrsLiist.length>0?this.$confirm("删除后，则此字段及其历史用户信息，将从系统中彻底删除，且无法恢复，请谨慎操作，点击确认删除，则删除",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){t.deleteList()})).catch((function(){t.$message({type:"info",message:"已取消删除"})})):this.$message.warning("请选择需要删除的字段")},channelInputLimit:function(t){var e=t.key;return"e"!==e&&"."!==e||(t.returnValue=!1,!1)}},components:{Card:n.default,TableContAdd:r.default}}},DOZk:function(t,e,s){"use strict";s.r(e);var i=s("SSzs"),n=s("eodn");for(var r in n)["default"].indexOf(r)<0&&function(t){s.d(e,t,(function(){return n[t]}))}(r);var o=s("KHd+"),a=Object(o.a)(n.default,i.a,i.b,!1,null,null,null);e.default=a.exports},SSzs:function(t,e,s){"use strict";s.d(e,"a",(function(){return i})),s.d(e,"b",(function(){return n}));var i=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"register-option-box"},[s("Card",{staticStyle:{"border-bottom":"none"},attrs:{header:"配置注册扩展信息"}}),t._v(" "),s("div",{staticClass:"register-option-table"},[s("el-table",{ref:"multipleTable",staticStyle:{width:"100%"},attrs:{data:t.groupsList,"tooltip-effect":"dark"},on:{"selection-change":t.handleSelectionChange}},[s("el-table-column",{attrs:{type:"selection",width:"50"}}),t._v(" "),s("el-table-column",{attrs:{label:"字段名称"},scopedSlots:t._u([{key:"default",fn:function(e){return[s("el-input",{attrs:{clearable:""},model:{value:e.row.name,callback:function(s){t.$set(e.row,"name",s)},expression:"scope.row.name"}})]}}])}),t._v(" "),s("el-table-column",{attrs:{label:"字段类型"},scopedSlots:t._u([{key:"default",fn:function(e){return[s("el-select",{staticClass:"register-option-table__choice",attrs:{placeholder:"请选择"},on:{change:t.obtainValue},model:{value:e.row.description,callback:function(s){t.$set(e.row,"description",s)},expression:"scope.row.description"}},t._l(t.options,(function(t){return s("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})})),1),t._v(" "),2===e.row.description||3===e.row.description?s("div",{staticClass:"register-option-table__type"},[s("el-input",{staticClass:"register-option-table__son",attrs:{type:"textarea",rows:2,placeholder:"输入值，每行一个选项值"},model:{value:e.row.content,callback:function(s){t.$set(e.row,"content",s)},expression:"scope.row.content"}})],1):t._e()]}}])}),t._v(" "),s("el-table-column",{attrs:{label:"字段排序"},scopedSlots:t._u([{key:"default",fn:function(e){return[s("el-input",{attrs:{type:"number",clearable:""},on:{input:t.changInput},nativeOn:{keydown:function(e){return t.channelInputLimit.apply(null,arguments)}},model:{value:e.row.sort,callback:function(s){t.$set(e.row,"sort",s)},expression:"scope.row.sort"}})]}}])}),t._v(" "),s("el-table-column",{attrs:{label:"字段介绍"},scopedSlots:t._u([{key:"default",fn:function(e){return[s("el-input",{attrs:{clearable:""},model:{value:e.row.introduce,callback:function(s){t.$set(e.row,"introduce",s)},expression:"scope.row.introduce"}})]}}])}),t._v(" "),s("el-table-column",{attrs:{label:"是否启用"},scopedSlots:t._u([{key:"default",fn:function(e){return[s("div",{staticClass:"register-option-table__enable"},[s("el-checkbox",{staticClass:"register-option-table__field",model:{value:e.row.enable,callback:function(s){t.$set(e.row,"enable",s)},expression:"scope.row.enable"}})],1)]}}])}),t._v(" "),s("el-table-column",{attrs:{label:"是否必填"},scopedSlots:t._u([{key:"default",fn:function(e){return[s("div",{staticClass:"register-option-table__enable"},[s("el-checkbox",{staticClass:"register-option-table__field",model:{value:e.row.required,callback:function(s){t.$set(e.row,"required",s)},expression:"scope.row.required"}})],1)]}}])}),t._v(" "),s("el-table-column",{attrs:{label:"操作"},scopedSlots:t._u([{key:"default",fn:function(e){return[s("div",{staticClass:"register-option-table__detele"},[s("el-button",{attrs:{type:"text"},on:{click:function(s){return t.operationDelete(e)}}},[t._v("删除")])],1)]}}])})],1),t._v(" "),s("Card",[s("div",{staticClass:"egister-option-btn",on:{click:t.increaseList}},[s("i",{staticClass:"el-icon-circle-plus-outline"}),t._v(" "),s("span",{staticClass:"egister-option-increase"},[t._v("新增字段")])])]),t._v(" "),s("Card",{staticClass:"register-option-btn"},[s("el-button",{attrs:{type:"primary",loading:t.subLoading,size:"medium"},on:{click:t.submitClick}},[t._v("提交")]),t._v(" "),s("el-button",{staticClass:"register-option__button",attrs:{type:"primary",loading:t.subLoading,size:"medium"},on:{click:t.submitDetele}},[t._v("删除")])],1)],1)],1)},n=[]},eodn:function(t,e,s){"use strict";s.r(e);var i=s("g7Zn"),n=s.n(i);for(var r in i)["default"].indexOf(r)<0&&function(t){s.d(e,t,(function(){return i[t]}))}(r);e.default=n.a},g7Zn:function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=r(s("QbLZ"));s("lpfh");var n=r(s("AWfW"));function r(t){return t&&t.__esModule?t:{default:t}}e.default=(0,i.default)({name:"registration-btn"},n.default)}}]);